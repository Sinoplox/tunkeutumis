# H2 tehtävä

## X)
  Pyramid of Pain
  
  - Näyttää tasot mitkä ovat helpoimmat hyökkääjälle vaihtaa pyramidina.

  Timanttimalli

  - Ideana että kaikki hyökkäykset voidaan jakaa neljään osaan: "Adversary, Infrastructure, Capability, Victim" ja
    tämä sijoittaa timanttiin joka sitten auttaa ymmärtää hyökkäykset ja niitten vastustaminen.

## A)

Kun yritin asentaa apache2, kali sanoi että tämä jo asennettu ja uusin versio. Käynnistin sen komennolla sudo systemctl start apache2

Avasin firefox kali:ssa ja menin localhost:iin, tämän jälkeen näkyy nämä tiedot apache2:n lokissa.

<img width="1700" height="115" alt="image" src="https://github.com/user-attachments/assets/e80155b9-9a23-49f5-b326-fe39935547f5" />

Lokitiedostosta näkyy mistä ip:stä tähän sivuun päädyttiin (127.0.0.1) eli localhostista.

Siinä näkyy myös päivämäärä ja aika milloin kävin, millä selaimella, millä käyttöjärestelmällä siinä sivussa käytiin.

## B)

<img width="843" height="372" alt="image" src="https://github.com/user-attachments/assets/cfb0b371-9259-49b1-8438-77ca49006a3a" />

Ajoin nmap -A komento localhostiin missä "-A" pistää skannauksen agressiiviseen tilaan joka aktivoi:
 
 -O joka tarkistaa käyttöjärjestelmän
 
 -sV joka skannaa softaversiot mitkä ovat niillä porteilla
 
 -script=default joka ajaa skriptit mitkä on luokiteltu defaultiksi
 
 --traceroute joka näyttää koko matka tietylle palvelimelle (tässä tapauksessa 0 koska localhost)

 Tuloksista näkyy että 999 porttia on kiinni, 1 auki: 80
 Portti 80 takana on apache2 jonka versio on 2.4.65
 Http titlestä voi päätellä että se on apachen starttisivu

 ## C)

   Vissiin selitin jo B) kohdassa että ne skriptit mitkä kuuluvat Default ryhmään. Esim: Http-title

   Ehkä ymmärsin väärin emt.

## D)

<img width="1425" height="453" alt="image" src="https://github.com/user-attachments/assets/3e1c669d-436e-49a1-ae1d-500cb05cbdb5" />

Lokitiedostossa näkee selvästi että apachea on skannattu "Nmap Scripting Engine":llä 

Sana Nmap on isolla.

En tiedä miten voin selittää noita lokeja paremmin kuin että siinä näkyy jäljet Nmap:in pyynnöistä niin kuin robots.txt

Lokitiedostosta voi varmaankin tunnistaa Nmap sen nimestä tai jos se on vaihdettu niin Options pyynnöistä mitä ei näytä tulevan kun selaa sivua itse.

Varmaan voi tunnistaa sen siitä miten Nmap kysyy tietoja??

## E)

Kun tarkastelee verkkoliikennettä wireshark:illa ja samalla porttiskannaa:

<img width="1238" height="383" alt="image" src="https://github.com/user-attachments/assets/62749248-4a9d-4f40-84ac-f7d033f20292" />

Aluksi tuli tuhansia "virheitä"? tuntuu olevan vastauksia siitä että ei vastausta.

Tässä rivissä se näytti lähettävän koko nettisivu ja sen koodi:

<img width="1044" height="16" alt="image" src="https://github.com/user-attachments/assets/784a291f-ea89-4f04-8043-e941488e181c" />

En aluksi löytänyt m itään kohtaa missä lukisi Nmap mutta myöhemmin löyty se sama viesti mikä oli apachen lokitiedostossa:

<img width="1763" height="347" alt="image" src="https://github.com/user-attachments/assets/948c4ce1-0af4-400f-8f5c-bd5be5a14c50" />

Siinä näkyi just User-Agentin kertomus nmapi:sta.

## F)

Sieppasin liikenteen komennolla sudo ngrep -d lo -i nmap missä -d osoittaa mitä interfacea kuuntelee, tässä tapauksessa "lo"
-i taaskin antaa mahdollisuuden tarkkailla Nmap nimisiä riviä, -i myös matchaa isot ja pienet kirjaimet.

<img width="1880" height="494" alt="image" src="https://github.com/user-attachments/assets/06ea5026-5565-4d5b-83a2-1aa58f1085d1" />

## G)

En tiedä mitä tapahtui mutta kun ajoin komennon nmap -p80 -script 'http-*' --script-args 'http.useragent=kakkazilla megafox 5.0' localhost (joo olen väsynyt)
niin se jumitti 5.43%:iin ja mukama oisi mennyt 2 tuntia lisää skannata.

<img width="620" height="222" alt="image" src="https://github.com/user-attachments/assets/238a7d26-b154-447c-801d-179a4378c629" />

pysäytin sen tekemällä ctrl-c.

Lokitiedostossa kyllä näkyi eka kysely.

<img width="934" height="39" alt="image" src="https://github.com/user-attachments/assets/fafd42a7-8bb1-40e9-b5c3-1c9312a971e5" />

Siinä myös näky että vaikka useragent on vaidettu eikä ole enään nmap. Niin nmap silti näkyy kohdassa /nmaplowercheck

## I)

Löysin grep -ir "lowercheck" komennolla tuon nimen tiedostosta http.lua.

En tiedä pitääkö tätä muokata vai jotain muuta mutta en alkanu tökkii varsinkin kun nmap jostai syystä jäi jumiin viime komennolla.

<img width="600" height="85" alt="image" src="https://github.com/user-attachments/assets/9bf9936c-2000-4edd-a688-cd57f38dc967" />



